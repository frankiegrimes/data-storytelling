function updateData(){d3.csv("../assets/data/cisgender-int.csv",function(t,a){a.forEach(function(){var t=d3.keys(a[0]).filter(function(t){return"Answer"!==t});a.forEach(function(a){a.ages=t.map(function(t){return{name:t,value:+a[t]}})}),x0.domain(a.map(function(t){return t.Answer})),x1.domain(t).rangeRoundBands([0,x0.rangeBand()]),y.domain([0,d3.max(a,function(t){return d3.max(t.ages,function(t){return t.value})})]);var e=d3.select("#chart-1").transition();e.selectAll(".rectangle").style("fill","red"),e.select(".x.axis").duration(750).call(xAxis),e.select(".y.axis").duration(750).call(yAxis)})})}var margin={top:20,right:20,bottom:30,left:40},width=960-margin.left-margin.right,height=500-margin.top-margin.bottom,x0=d3.scale.ordinal().rangeRoundBands([0,width],.1),x1=d3.scale.ordinal(),y=d3.scale.linear().range([height,0]),color=d3.scale.ordinal().range(["#4db8ff","0099ff","#006bb3"]),xAxis=d3.svg.axis().scale(x0).orient("bottom"),yAxis=d3.svg.axis().scale(y).orient("left").tickFormat(d3.format(".2s")),svg=d3.select("#chart-1").append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")"),tooltip=d3.select("#chart-1").append("div").attr("class","tooltip");tooltip.append("div").attr("class","value"),d3.csv("../assets/data/cisgender-age.csv",function(t,a){if(t)throw t;var e=d3.keys(a[0]).filter(function(t){return"Answer"!==t});a.forEach(function(t){t.ages=e.map(function(a){return{name:a,value:+t[a]}})}),x0.domain(a.map(function(t){return t.Answer})),x1.domain(e).rangeRoundBands([0,x0.rangeBand()]),y.domain([0,d3.max(a,function(t){return d3.max(t.ages,function(t){return t.value})})]),svg.append("g").attr("class","x axis").attr("transform","translate(0,"+height+")").call(xAxis),svg.append("g").attr("class","y axis").call(yAxis).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Percentage");var n=svg.selectAll(".answer").data(a).enter().append("g").attr("class","answer").attr("transform",function(t){return"translate("+x0(t.Answer)+",0)"}),r=n.selectAll("rect").data(function(t){return t.ages}).enter().append("rect").attr("class","rectangle").attr("width",x1.rangeBand()).attr("x",function(t){return x1(t.name)}).attr("y",function(t){return y(t.value)}).attr("height",function(t){return height-y(t.value)}).style("fill",function(t){return color(t.name)}),i=svg.selectAll(".legend").data(e.slice().reverse()).enter().append("g").attr("class","legend").attr("transform",function(t,a){return"translate(0,"+20*a+")"});i.append("rect").attr("x",width-18).attr("width",18).attr("height",18).style("fill",color),i.append("text").attr("x",width-24).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t}),r.on("mouseover",function(t){tooltip.select(".value").html(t.value+"%"),tooltip.style("display","block")}),r.on("mouseout",function(){tooltip.style("display","none")}),r.on("mousemove",function(){tooltip.style("top",d3.event.layerY+10+"px").style("left",d3.event.layerX+10+"px")})});