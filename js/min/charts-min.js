function chart1(){var t={top:20,right:20,bottom:30,left:40},e=960-t.left-t.right,a=500-t.top-t.bottom,n=d3.scale.ordinal().rangeRoundBands([0,e],.1),r=d3.scale.ordinal(),l=d3.scale.linear().range([a,0]),s=d3.scale.ordinal().range(["#4db8ff","0099ff","#006bb3"]),o=d3.svg.axis().scale(n).orient("bottom"),c=d3.svg.axis().scale(l).orient("left"),d=d3.select("#chart-1").append("svg").attr("width",e+t.left+t.right).attr("height",a+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")"),i=d3.select("#chart-1").append("div").attr("class","tooltip");i.append("div").attr("class","value"),d3.csv("../assets/data/cisgender-age.csv",function(t,u){if(t)throw t;var f=d3.keys(u[0]).filter(function(t){return"Answer"!==t});u.forEach(function(t){t.ages=f.map(function(e){return{name:e,value:+t[e]}})}),n.domain(u.map(function(t){return t.Answer})),r.domain(f).rangeRoundBands([0,n.rangeBand()]),l.domain([0,d3.max(u,function(t){return d3.max(t.ages,function(t){return t.value})})]),d.append("g").attr("class","x axis").attr("transform","translate(0,"+a+")").call(o),d.append("g").attr("class","y axis").call(c).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Percentage");var p=d.selectAll(".answer").data(u).enter().append("g").attr("class","answer").attr("transform",function(t){return"translate("+n(t.Answer)+",0)"}),g=p.selectAll("rect").data(function(t){return t.ages}).enter().append("rect").attr("class","rectangle").attr("width",r.rangeBand()).attr("x",function(t){return r(t.name)}).attr("y",function(t){return l(t.value)}).attr("height",function(t){return a-l(t.value)}).style("fill",function(t){return s(t.name)}),m=d.selectAll(".legend").data(f.slice().reverse()).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(0,"+20*e+")"});m.append("rect").attr("x",e-18).attr("width",18).attr("height",18).style("fill",s),m.append("text").attr("x",e-24).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t}),g.on("mouseover",function(t){i.select(".value").html(t.value+"%"),i.style("display","block")}),g.on("mouseout",function(){i.style("display","none")}),g.on("mousemove",function(){i.style("top",d3.event.layerY+10+"px").style("left",d3.event.layerX+10+"px")})})}function chart2(){var t={top:20,right:20,bottom:30,left:40},e=960-t.left-t.right,a=500-t.top-t.bottom,n=d3.scale.ordinal().rangeRoundBands([0,e],.1),r=d3.scale.ordinal(),l=d3.scale.linear().range([a,0]),s=d3.scale.ordinal().range(["#4db8ff","0099ff","#006bb3"]),o=d3.svg.axis().scale(n).orient("bottom"),c=d3.svg.axis().scale(l).orient("left"),d=d3.select("#chart-1").append("svg").attr("width",e+t.left+t.right).attr("height",a+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")"),i=d3.select("#chart-1").append("div").attr("class","tooltip");i.append("div").attr("class","value"),d3.csv("../assets/data/cisgender-int.csv",function(t,u){if(t)throw t;var f=d3.keys(u[0]).filter(function(t){return"Answer"!==t});u.forEach(function(t){t.ages=f.map(function(e){return{name:e,value:+t[e]}})}),n.domain(u.map(function(t){return t.Answer})),r.domain(f).rangeRoundBands([0,n.rangeBand()]),l.domain([0,d3.max(u,function(t){return d3.max(t.ages,function(t){return t.value})})]),d.append("g").attr("class","x axis").attr("transform","translate(0,"+a+")").call(o),d.append("g").attr("class","y axis").call(c).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Percentage");var p=d.selectAll(".answer").data(u).enter().append("g").attr("class","answer").attr("transform",function(t){return"translate("+n(t.Answer)+",0)"}),g=p.selectAll("rect").data(function(t){return t.ages}).enter().append("rect").attr("class","rectangle").attr("width",r.rangeBand()).attr("x",function(t){return r(t.name)}).attr("y",function(t){return l(t.value)}).attr("height",function(t){return a-l(t.value)}).style("fill",function(t){return s(t.name)}),m=d.selectAll(".legend").data(f.slice().reverse()).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(0,"+20*e+")"});m.append("rect").attr("x",e-18).attr("width",18).attr("height",18).style("fill",s),m.append("text").attr("x",e-24).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t}),g.on("mouseover",function(t){i.select(".value").html(t.value+"%"),i.style("display","block")}),g.on("mouseout",function(){i.style("display","none")}),g.on("mousemove",function(){i.style("top",d3.event.layerY+10+"px").style("left",d3.event.layerX+10+"px")})})}function chart3(){var t={top:40,right:20,bottom:30,left:40},e=960-t.left-t.right,a=800-t.top-t.bottom,n=d3.scale.ordinal().rangeRoundBands([0,e],.1),r=d3.scale.ordinal(),l=d3.scale.linear().range([a,0]),s=d3.scale.ordinal().range(["#4db8ff","0099ff","#006bb3"]),o=d3.svg.axis().scale(n).orient("bottom"),c=d3.svg.axis().scale(l).orient("left"),d=d3.select("#chart-3").append("svg").attr("width",e+t.left+t.right).attr("height",a+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")"),i=d3.select("#chart-1").append("div").attr("class","tooltip");i.append("div").attr("class","value"),d3.csv("../assets/data/trans-friend-age.csv",function(t,u){if(t)throw t;var f=d3.keys(u[0]).filter(function(t){return"Answer"!==t});u.forEach(function(t){t.ages=f.map(function(e){return{name:e,value:+t[e]}})}),n.domain(u.map(function(t){return t.Answer})),r.domain(f).rangeRoundBands([0,n.rangeBand()]),l.domain([0,d3.max(u,function(t){return d3.max(t.ages,function(t){return t.value})})]),d.append("g").attr("class","x axis").attr("transform","translate(0,"+a+")").call(o),d.append("g").attr("class","y axis").call(c).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Percentage");var p=d.selectAll(".answer").data(u).enter().append("g").attr("class","answer").attr("transform",function(t){return"translate("+n(t.Answer)+",0)"}),g=p.selectAll("rect").data(function(t){return t.ages}).enter().append("rect").attr("class","rectangle").attr("width",r.rangeBand()).attr("x",function(t){return r(t.name)}).attr("y",function(t){return l(t.value)}).attr("height",function(t){return a-l(t.value)}).style("fill",function(t){return s(t.name)}),m=d.selectAll(".legend").data(f.slice().reverse()).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(0,"+20*e+")"});m.append("rect").attr("x",e-18).attr("width",18).attr("height",18).style("fill",s),m.append("text").attr("x",e-24).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t}),g.on("mouseover",function(t){i.select(".value").html(t.value+"%"),i.style("display","block")}),g.on("mouseout",function(){i.style("display","none")}),g.on("mousemove",function(){i.style("top",d3.event.layerY+10+"px").style("left",d3.event.layerX+10+"px")})})}function chart4(){var t=[{label:"Newspapers",count:77},{label:"Television",count:140},{label:"Magazines",count:71},{label:"Film",count:114},{label:"Books",count:38},{label:"Radio",count:38},{label:"Internet",count:136}],e=700,a=e,n=Math.min(e,a)/2,r=e/5,l=e/20,s=e/100,o=d3.scale.category20c(),c=d3.select("#chart-4").append("svg").attr("width",e).attr("height",a).append("g").attr("transform","translate("+e/2+","+a/2+")"),d=d3.svg.arc().innerRadius(n-r).outerRadius(n),i=d3.layout.pie().value(function(t){return t.count}).sort(null),u=d3.select("#chart-4").append("div").attr("class","tooltip");u.append("div").attr("class","label"),u.append("div").attr("class","count"),u.append("div").attr("class","percent"),t.forEach(function(t){t.count=+t.count,t.enabled=!0});var f=c.selectAll("path").data(i(t)).enter().append("path").attr("d",d).attr("fill",function(t,e){return o(t.data.label)}).each(function(t){this._current=t});f.on("mouseover",function(e){var a=d3.sum(t.map(function(t){return t.enabled?t.count:0})),n=Math.round(1e3*e.data.count/a)/10;u.select(".label").html(e.data.label),u.select(".count").html(e.data.count),u.select(".percent").html(n+"%"),u.style("display","block")}),f.on("mouseout",function(t){u.style("display","none")});var p=c.selectAll(".legend").data(o.domain()).enter().append("g").attr("class","legend").attr("transform",function(t,e){var a=l+s,n=a*o.domain().length/2,r=-2*l,c=e*a-n;return"translate("+r+","+c+")"});p.append("rect").attr("width",l).attr("height",l).style("fill",o).style("stroke",o).on("click",function(e){var a=d3.select(this),n=!0,r=d3.sum(t.map(function(t){return t.enabled?1:0}));if("disabled"===a.attr("class"))a.attr("class","");else{if(2>r)return;a.attr("class","disabled"),n=!1}i.value(function(t){return t.label===e?(t.enabled=n,t.enabled?t.count:0):void 0}),f=f.data(i(t)),f.transition().duration(750).attrTween("d",function(t){var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){return d(e(t))}})}),p.append("text").attr("x",l+s).attr("y",l-s).text(function(t){return t})}function chart5(){var t={top:30,right:30,bottom:40,left:50},e=960-t.left-t.right,a=500-t.top-t.bottom,n=d3.scale.ordinal().rangeRoundBands([0,e],.1),r=d3.scale.linear().rangeRound([a,0]),l=d3.scale.ordinal().range(["#4db8ff","0099ff","#006bb3"]),s=d3.svg.axis().scale(n).orient("bottom"),o=d3.svg.axis().scale(r).orient("left").tickFormat(d3.format(".2s")),c=d3.select("#chart-5").append("svg").attr("width",e+t.left+t.right).attr("height",a+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")");d3.csv("../assets/data/organisations-age.csv",function(t,d){if(t)throw t;l.domain(d3.keys(d[0]).filter(function(t){return"organisation"!==t})),d.forEach(function(t){var e=0;t.ages=l.domain().map(function(a){return{name:a,y0:e,y1:e+=+t[a]}}),t.total=t.ages[t.ages.length-1].y1}),d.sort(function(t,e){return e.total-t.total}),n.domain(d.map(function(t){return t.organisation})),r.domain([0,d3.max(d,function(t){return t.total})]),c.append("g").attr("class","x axis").attr("transform","translate(0,"+a+")").call(s),c.append("g").attr("class","y axis").call(o).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Percentage");var i=c.selectAll(".organisation").data(d).enter().append("g").attr("class","g").attr("transform",function(t){return"translate("+n(t.organisation)+",0)"});i.selectAll("rect").data(function(t){return t.ages}).enter().append("rect").attr("width",n.rangeBand()).attr("y",function(t){return r(t.y1)}).attr("height",function(t){return r(t.y0)-r(t.y1)}).style("fill",function(t){return l(t.name)});var u=c.selectAll(".legend").data(l.domain().slice().reverse()).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(0,"+20*e+")"});u.append("rect").attr("x",e-18).attr("width",18).attr("height",18).style("fill",l),u.append("text").attr("x",e-24).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t})})}chart1(),chart3(),chart4(),chart5();