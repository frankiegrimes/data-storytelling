var dataset=[{label:"Newspapers",count:60},{label:"TV",count:20},{label:"Social Media",count:15},{label:"Film",count:1}],width=360,height=360,radius=Math.min(width,height)/2,donutWidth=75,legendRectSize=18,legendSpacing=4,color=d3.scale.category20b(),graph4=d3.select("#chart-1").append("svg").attr("width",width).attr("height",height).append("g").attr("transform","translate("+width/2+","+height/2+")"),arc=d3.svg.arc().innerRadius(radius-donutWidth).outerRadius(radius),pie=d3.layout.pie().value(function(t){return t.count}).sort(null),tooltip=d3.select("#area4").append("div").attr("class","tooltip");tooltip.append("div").attr("class","label"),tooltip.append("div").attr("class","count"),tooltip.append("div").attr("class","percent"),dataset.forEach(function(t){t.count=+t.count,t.enabled=!0});var path=graph4.selectAll("path").data(pie(dataset)).enter().append("path").attr("d",arc).attr("fill",function(t,e){return color(t.data.label)}).each(function(t){this._current=t});path.on("mouseover",function(t){var e=d3.sum(dataset.map(function(t){return t.enabled?t.count:0})),a=Math.round(1e3*t.data.count/e)/10;tooltip.select(".label").html(t.data.label),tooltip.select(".count").html(t.data.count),tooltip.select(".percent").html(a+"%"),tooltip.style("display","block")}),path.on("mouseout",function(t){tooltip.style("display","none")});var legend=graph4.selectAll(".legend").data(color.domain()).enter().append("g").attr("class","legend").attr("transform",function(t,e){var a=legendRectSize+legendSpacing,n=a*color.domain().length/2,r=-2*legendRectSize,i=e*a-n;return"translate("+r+","+i+")"});legend.append("rect").attr("width",legendRectSize).attr("height",legendRectSize).style("fill",color).style("stroke",color).on("click",function(t){var e=d3.select(this),a=!0,n=d3.sum(dataset.map(function(t){return t.enabled?1:0}));if("disabled"===e.attr("class"))e.attr("class","");else{if(2>n)return;e.attr("class","disabled"),a=!1}pie.value(function(e){return e.label===t&&(e.enabled=a),e.enabled?e.count:0}),path=path.data(pie(dataset)),path.transition().duration(750).attrTween("d",function(t){var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){return arc(e(t))}})}),legend.append("text").attr("x",legendRectSize+legendSpacing).attr("y",legendRectSize-legendSpacing).text(function(t){return t});var w=500,h=100,barPadding=1,dataset=[5,10,13,19,21,25,22,18,15,13,11,12,15,20,18,17,16,18,23,25],graph2=d3.select("#chart-2").append("svg").attr("width",w).attr("height",h);graph2.selectAll("rect").data(dataset).enter().append("rect").attr("x",function(t,e){return e*(w/dataset.length)}).attr("y",function(t){return h-4*t}).attr("width",w/dataset.length-barPadding).attr("height",function(t){return 4*t}).attr("fill",function(t){return"rgb(0, 0, "+10*t+")"}),graph2.selectAll("text").data(dataset).enter().append("text").text(function(t){return t}).attr("text-anchor","middle").attr("x",function(t,e){return e*(w/dataset.length)+(w/dataset.length-barPadding)/2}).attr("y",function(t){return h-4*t+14}).attr("font-family","sans-serif").attr("font-size","11px").attr("fill","white");var margin={top:20,right:20,bottom:30,left:40},width=960-margin.left-margin.right,height=500-margin.top-margin.bottom,formatPercent=d3.format(".0%"),x=d3.scale.ordinal().rangeRoundBands([0,width],.1,1),y=d3.scale.linear().range([height,0]),xAxis=d3.svg.axis().scale(x).orient("bottom"),yAxis=d3.svg.axis().scale(y).orient("left").tickFormat(formatPercent),svg=d3.select("#chart-3").append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")");d3.tsv("assets/data/data.tsv",function(t,e){function a(){clearTimeout(n);var t=x.domain(e.sort(this.checked?function(t,e){return e.frequency-t.frequency}:function(t,e){return d3.ascending(t.letter,e.letter)}).map(function(t){return t.letter})).copy();svg.selectAll(".bar").sort(function(e,a){return t(e.letter)-t(a.letter)});var a=svg.transition().duration(750),r=function(t,e){return 50*e};a.selectAll(".bar").delay(r).attr("x",function(e){return t(e.letter)}),a.select(".x.axis").call(xAxis).selectAll("g").delay(r)}e.forEach(function(t){t.frequency=+t.frequency}),x.domain(e.map(function(t){return t.letter})),y.domain([0,d3.max(e,function(t){return t.frequency})]),svg.append("g").attr("class","x axis").attr("transform","translate(0,"+height+")").call(xAxis),svg.append("g").attr("class","y axis").call(yAxis).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Frequency"),svg.selectAll(".bar").data(e).enter().append("rect").attr("class","bar").attr("x",function(t){return x(t.letter)}).attr("width",x.rangeBand()).attr("y",function(t){return y(t.frequency)}).attr("height",function(t){return height-y(t.frequency)}),d3.select("input").on("change",a);var n=setTimeout(function(){d3.select("input").property("checked",!0).each(a)},2e3)});