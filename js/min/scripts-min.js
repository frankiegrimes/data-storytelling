function chart1(){var t=[{label:"Newspapers",count:77},{label:"Television",count:140},{label:"Magazines",count:71},{label:"Film",count:114},{label:"Books",count:38},{label:"Radio",count:38},{label:"Internet",count:136}],a=1e3,e=a,n=Math.min(a,e)/2,r=a/5,o=a/20,l=a/100,s=d3.scale.category20b(),i=d3.select("#chart-1").append("svg").attr("width",a).attr("height",e).append("g").attr("transform","translate("+a/2+","+e/2+")"),c=d3.svg.arc().innerRadius(n-r).outerRadius(n),d=d3.layout.pie().value(function(t){return t.count}).sort(null),u=d3.select("#chart-1").append("div").attr("class","tooltip");u.append("div").attr("class","label"),u.append("div").attr("class","count"),u.append("div").attr("class","percent"),t.forEach(function(t){t.count=+t.count,t.enabled=!0});var p=i.selectAll("path").data(d(t)).enter().append("path").attr("d",c).attr("fill",function(t,a){return s(t.data.label)}).each(function(t){this._current=t});p.on("mouseover",function(a){var e=d3.sum(t.map(function(t){return t.enabled?t.count:0})),n=Math.round(1e3*a.data.count/e)/10;u.select(".label").html(a.data.label),u.select(".count").html(a.data.count),u.select(".percent").html(n+"%"),u.style("display","block")}),p.on("mouseout",function(t){u.style("display","none")});var f=i.selectAll(".legend").data(s.domain()).enter().append("g").attr("class","legend").attr("transform",function(t,a){var e=o+l,n=e*s.domain().length/2,r=-2*o,i=a*e-n;return"translate("+r+","+i+")"});f.append("rect").attr("width",o).attr("height",o).style("fill",s).style("stroke",s).on("click",function(a){var e=d3.select(this),n=!0,r=d3.sum(t.map(function(t){return t.enabled?1:0}));if("disabled"===e.attr("class"))e.attr("class","");else{if(2>r)return;e.attr("class","disabled"),n=!1}d.value(function(t){return t.label===a?(t.enabled=n,t.enabled?t.count:0):void 0}),p=p.data(d(t)),p.transition().duration(750).attrTween("d",function(t){var a=d3.interpolate(this._current,t);return this._current=a(0),function(t){return c(a(t))}})}),f.append("text").attr("x",o+l).attr("y",o-l).text(function(t){return t})}function graph3(){var t={top:20,right:20,bottom:30,left:40},a=1e3,e=a/1.5-t.top-t.bottom,n=d3.format(".0%"),r=d3.scale.ordinal().rangeRoundBands([0,a],.1,1),o=d3.scale.linear().range([e,0]),l=d3.svg.axis().scale(r).orient("bottom"),s=d3.svg.axis().scale(o).orient("left").tickFormat(n),i=d3.select("#chart-3").append("svg").attr("width",a+t.left+t.right).attr("height",e+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")");d3.tsv("assets/data/organisations-int.csv",function(t,a){function n(){clearTimeout(c);var t=r.domain(a.sort(this.checked?function(t,a){return a.post-t.post}:function(t,a){return d3.ascending(t.organisation,a.organisation)}).map(function(t){return t.organisation})).copy();i.selectAll(".bar").sort(function(a,e){return t(a.organisation)-t(e.organisation)});var e=i.transition().duration(750),n=function(t,a){return 50*a};e.selectAll(".bar").delay(n).attr("x",function(a){return t(a.organisation)}),e.select(".x.axis").call(l).selectAll("g").delay(n)}a.forEach(function(t){t.post=+t.post}),r.domain(a.map(function(t){return t.organisation})),o.domain([0,d3.max(a,function(t){return t.post})]),i.append("g").attr("class","x axis").attr("transform","translate(0,"+e+")").call(l),i.append("g").attr("class","y axis").call(s).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Post-Internet"),i.selectAll(".bar").data(a).enter().append("rect").attr("class","bar").attr("x",function(t){return r(t.organisation)}).attr("width",r.rangeBand()).attr("y",function(t){return o(t.post)}).attr("height",function(t){return e-o(t.post)}),d3.select("input").on("change",n);var c=setTimeout(function(){d3.select("input").property("checked",!0).each(n)},2e3)})}function graph5(){function t(t){var a=(t.endAngle-t.startAngle)/t.value;return d3.range(0,t.value,1e3).map(function(e,n){return{angle:e*a+t.startAngle,label:n%5?null:e/1e3+"k"}})}function a(t){return function(a,e){c.selectAll(".chord path").filter(function(t){return t.source.index!==e&&t.target.index!==e}).transition().style("opacity",t)}}var e=[[11975,5871,8916,2868],[1951,10048,2060,6171],[8010,16145,8090,8045],[1013,990,940,6907]],n=d3.layout.chord().padding(.05).sortSubgroups(d3.descending).matrix(e),r=1e3,o=r/2,l=.41*Math.min(r,o),s=1.1*l,i=d3.scale.ordinal().domain(d3.range(4)).range(["#000000","#FFDD89","#957244","#F26223"]),c=d3.select("#chart-5").append("svg").attr("width",r).attr("height",o).append("g").attr("transform","translate("+r/2+","+o/2+")");c.append("g").selectAll("path").data(n.groups).enter().append("path").style("fill",function(t){return i(t.index)}).style("stroke",function(t){return i(t.index)}).attr("d",d3.svg.arc().innerRadius(l).outerRadius(s)).on("mouseover",a(.1)).on("mouseout",a(1));var d=c.append("g").selectAll("g").data(n.groups).enter().append("g").selectAll("g").data(t).enter().append("g").attr("transform",function(t){return"rotate("+(180*t.angle/Math.PI-90)+")translate("+s+",0)"});d.append("line").attr("x1",1).attr("y1",0).attr("x2",5).attr("y2",0).style("stroke","#000"),d.append("text").attr("x",8).attr("dy",".35em").attr("transform",function(t){return t.angle>Math.PI?"rotate(180)translate(-16)":null}).style("text-anchor",function(t){return t.angle>Math.PI?"end":null}).text(function(t){return t.label}),c.append("g").attr("class","chord").selectAll("path").data(n.chords).enter().append("path").attr("d",d3.svg.chord().radius(l)).style("fill",function(t){return i(t.target.index)}).style("opacity",1)}function graph4(){var t={top:20,right:20,bottom:30,left:40},a=1e3,e=a/3-t.top-t.bottom,n=d3.scale.ordinal().rangeRoundBands([0,a],.1),r=d3.scale.ordinal(),o=d3.scale.linear().range([e,0]),l=d3.scale.ordinal().range(["#98abc5","#8a89a6","#7b6888","#6b486b","#a05d56","#d0743c","#ff8c00"]),s=d3.svg.axis().scale(n).orient("bottom"),i=d3.svg.axis().scale(o).orient("left").tickFormat(d3.format(".2s")),c=d3.select("#chart-4").append("svg").attr("width",a+t.left+t.right).attr("height",e+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")");d3.csv("../assets/data/data.csv",function(t,d){if(t)throw t;var u=d3.keys(d[0]).filter(function(t){return"State"!==t});d.forEach(function(t){t.ages=u.map(function(a){return{name:a,value:+t[a]}})}),n.domain(d.map(function(t){return t.State})),r.domain(u).rangeRoundBands([0,n.rangeBand()]),o.domain([0,d3.max(d,function(t){return d3.max(t.ages,function(t){return t.value})})]),c.append("g").attr("class","x axis").attr("transform","translate(0,"+e+")").call(s),c.append("g").attr("class","y axis").call(i).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Population");var p=c.selectAll(".state").data(d).enter().append("g").attr("class","state").attr("transform",function(t){return"translate("+n(t.State)+",0)"});p.selectAll("rect").data(function(t){return t.ages}).enter().append("rect").attr("width",r.rangeBand()).attr("x",function(t){return r(t.name)}).attr("y",function(t){return o(t.value)}).attr("height",function(t){return e-o(t.value)}).style("fill",function(t){return l(t.name)});var f=c.selectAll(".legend").data(u.slice().reverse()).enter().append("g").attr("class","legend").attr("transform",function(t,a){return"translate(0,"+20*a+")"});f.append("rect").attr("x",a-18).attr("width",18).attr("height",18).style("fill",l),f.append("text").attr("x",a-24).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t})})}chart1(),graph3(),graph4();